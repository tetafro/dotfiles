#!/bin/bash
# Print all files and their video codecs from the current directory.
set -uo pipefail

# Files are provided as arguments
if [[ $# -gt 0 ]]; then
    for file in "$@"; do
        codec=$(ffprobe -v error -select_streams v:0 -show_entries stream=codec_name -of csv=p=0 "$file" 2>/dev/null)
        printf "%-80s %s\n" "$file" "$codec"
    done
    exit 0
fi

# Check all files in the current directory
find . -maxdepth 1 -type f | while read -r file; do
    codec=$(ffprobe -v error -select_streams v:0 -show_entries stream=codec_name -of csv=p=0 "$file" 2>/dev/null)
    printf "%-80s %s\n" "$file" "$codec"
done
